name: ChatOps
on:
  issue_comment:
    types: [ created,updated ] 
    
jobs:
  command:
    runs-on: ubuntu-latest    
    steps:
    - uses: peter-evans/repository-dispatch@v1
      if: contains(github.event.comment.body, '/clean')
      with:
        token: ${{ secrets.REPO_ACCESS_TOKEN }}
        event-type: release-to-env
    - uses: peter-evans/repository-dispatch@v1
      if: contains(github.event.comment.body, '/deploy')
      with:
        token: ${{ secrets.REPO_ACCESS_TOKEN }}
        event-type: release-to-prod
        client-payload: '{ "env": "qa" }'
